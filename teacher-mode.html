<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Grammar Spy™ — Teacher Mode</title>
  <link rel="icon" type="image/svg+xml" href="assets/brand/favicon.svg" />
  <style>
    :root{--navy:#0b1020;--mid:#16223a;--teal:#1f5f63;--light:#f2f4f7;--cool:#d9dee6;--slate:#4a5568;--shadow:0 10px 20px rgba(11,16,32,.08)}
    *{box-sizing:border-box}
    body{margin:0;background:var(--light);color:var(--mid);font-family:Inter,Montserrat,Poppins,Outfit,"Segoe UI",sans-serif;padding:22px 14px 34px}
    .wrap{max-width:900px;margin:0 auto;display:grid;gap:16px}
    .panel{background:#fff;border:1px solid var(--cool);border-radius:18px;box-shadow:var(--shadow)}
    .hero{padding:22px;display:grid;gap:8px}
    h1{margin:0;font-size:32px;color:var(--navy)}
    .sub{margin:0;color:var(--slate)}
    .form{padding:0 22px 22px;display:grid;gap:12px}
    label{font:700 11px Inter,Arial,sans-serif;letter-spacing:.08em;text-transform:uppercase;color:#4a5568}
    select{width:100%;border:1px solid var(--cool);border-radius:10px;padding:10px 12px;font:600 14px Inter,Arial,sans-serif;color:#16223a;background:#fff}
    .primary{display:inline-flex;align-items:center;justify-content:center;min-height:44px;padding:0 18px;border:1px solid #194f53;background:var(--teal);color:#fff;border-radius:10px;text-decoration:none;text-transform:uppercase;letter-spacing:.08em;font:700 12px Inter,Arial,sans-serif;width:fit-content}
    details{border:1px solid var(--cool);border-radius:12px;background:#f8fafc;padding:10px}
    summary{cursor:pointer;font:700 12px Inter,Arial,sans-serif;letter-spacing:.08em;text-transform:uppercase;color:#16223a}
    .row{display:grid;gap:8px;margin-top:8px}
    .cover-wrap{margin-top:2px;display:grid;gap:6px}
    .cover-card{border:1px solid #d9dee6;border-radius:12px;background:#fff;padding:8px}
    .cover-card img{display:block;width:100%;max-height:260px;object-fit:cover;border-radius:8px}
    .cover-card .difficulty-name{display:flex;align-items:center;justify-content:center;min-height:120px;padding:20px;background:linear-gradient(135deg,var(--mid) 0%,var(--navy) 100%);color:#fff;font:700 18px Inter,Arial,sans-serif;text-align:center;border-radius:8px}
    .cover-meta{font:700 11px Inter,Arial,sans-serif;letter-spacing:.06em;text-transform:uppercase;color:#4a5568}
    .icon-sm{width:18px;height:18px;vertical-align:middle;margin-right:6px;object-fit:contain}
  </style>
</head>
<body>
  <script src="i18n.js"></script>
  <div data-include="header"></div>
  <main class="wrap" id="main">
    <section class="panel">
      <div class="hero" style="display:grid;grid-template-columns:1fr auto;gap:20px;align-items:center">
        <div>
          <p id="k" style="margin:0;font:800 11px Inter,Arial,sans-serif;letter-spacing:.14em;text-transform:uppercase;color:#1f5f63">Teacher Mode</p>
          <h1 id="title">Teacher Mission Flow</h1>
          <p id="sub" class="sub">Choose one game, then continue.</p>
        </div>
        <img src="assets/illustrations/mission-setup.svg" alt="" style="width:180px;height:auto;opacity:.85" aria-hidden="true" />
      </div>
      <div class="form">
        <div>
          <label for="game">Game</label>
          <select id="game"></select>
        </div>
        <div>
          <label for="difficulty">Difficulty</label>
          <select id="difficulty"><option value="rookie">Rookie Agent</option><option value="field" selected>Field Agent</option><option value="director">Director</option></select>
        </div>
        <div>
          <label for="playFormat">Play Format</label>
          <select id="playFormat">
            <option value="whole_class" selected>Whole Class</option>
            <option value="teams">Teams</option>
            <option value="individuals">Individuals</option>
          </select>
        </div>
        <div class="cover-wrap" aria-live="polite">
          <span class="cover-meta">Difficulty</span>
          <div class="cover-card">
            <div id="difficultyCover" class="difficulty-name" aria-live="polite">Field Agent</div>
          </div>
        </div>
        <a id="continueBtn" class="primary" href="#">Continue</a>
        <details>
          <summary>Advanced</summary>
          <div class="row">
            <div><label for="count">Items</label><select id="count"><option selected>6</option><option>8</option><option>10</option></select></div>
            <div><label for="timer">Timer</label><select id="timer"><option value="on" selected>On</option><option value="off">Off</option></select></div>
            <a href="teacher-dashboard.html" style="color:#1f5f63;text-decoration:none;font:700 12px Inter,Arial,sans-serif;text-transform:uppercase;letter-spacing:.06em">Open Reports</a>
          </div>
        </details>
      </div>
    </section>
  </main>
  <div data-include="footer"></div>
  <script src="billing-scaffold.js"></script>
  <script src="auth-scaffold.js"></script>
  <script src="layout-loader.js"></script>
  <script src="app-shell.js"></script>
  <script>
    const packs = {
      pack01:{name:'Retell What Happened',grammar:'Simple Past + Past Continuous',games:[['Error Smash','error-smash.html'],['Drag & Sort','past-sort.html'],['Narrative Builder','narrative-builder.html'],['Dialogue Repair','dialogue-repair.html?pack=pack01'],['Rewrite Studio','rewrite-studio.html?pack=pack01']]},
      pack02:{name:'Speak In The Moment',grammar:'Present Simple + Present Continuous',games:[['Rule Sprint','rule-sprint-present.html'],['Signal Decoder','signal-decoder-present.html'],['Case Interview','present-case-interview.html'],['Dialogue Repair','dialogue-repair.html?pack=pack02'],['Rewrite Studio','rewrite-studio.html?pack=pack02']]},
      pack03:{name:'Sentence Confidence Missions',grammar:'am/is/are + Agreement',games:[['Rule Sprint','be-verb-rule-sprint.html'],['Agreement Sweep','be-verb-agreement-sweep.html'],['Case Interview','be-verb-case-interview.html'],['Dialogue Repair','dialogue-repair.html?pack=pack03'],['Rewrite Studio','rewrite-studio.html?pack=pack03']]},
      pack04:{name:'Link Ideas Clearly',grammar:'Connectors',games:[['Sequence Lab','mission-sequence-lab.html?pack=pack04'],['Evidence Sort','evidence-sort-board.html?pack=pack04'],['Dialogue Repair','dialogue-repair.html?pack=pack04'],['Rewrite Studio','rewrite-studio.html?pack=pack04'],['Clue Trail','clue-trail.html?pack=pack04']]},
      pack05:{name:'Reference Smartly',grammar:'Pronouns + Reference',games:[['Dialogue Repair','dialogue-repair.html?pack=pack05'],['Evidence Sort','evidence-sort-board.html?pack=pack05'],['Rewrite Studio','rewrite-studio.html?pack=pack05'],['Sequence Lab','mission-sequence-lab.html?pack=pack05'],['Clue Trail','clue-trail.html?pack=pack05']]},
      pack06:{name:'Question Flow Missions',grammar:'Yes/No + Wh Questions',games:[['Evidence Sort','evidence-sort-board.html?pack=pack06'],['Clue Trail','clue-trail.html?pack=pack06'],['Dialogue Repair','dialogue-repair.html?pack=pack06'],['Sequence Lab','mission-sequence-lab.html?pack=pack06'],['Rewrite Studio','rewrite-studio.html?pack=pack06']]}
    };
    const qp = new URLSearchParams(location.search);
    const packId = packs[qp.get('pack')] ? qp.get('pack') : 'pack01';
    const pack = packs[packId];
    document.getElementById('k').textContent = `Teacher Mode · ${pack.grammar}`;
    document.getElementById('title').textContent = pack.name;
    document.getElementById('sub').textContent = 'Choose one game, then continue.';

    const gameSel = document.getElementById('game');
    const coverEl = document.getElementById('difficultyCover');
    const DIFFICULTY_LABELS = { rookie: 'Rookie Agent', field: 'Field Agent', director: 'Director' };
    pack.games.forEach(([label,url]) => {
      const o=document.createElement('option'); o.value=url; o.textContent=label; gameSel.appendChild(o);
    });

    function syncHref(){
      const playFormat = document.getElementById('playFormat').value;
      const p = new URLSearchParams();
      p.set('pack', packId);
      p.set('mode', 'class');
      p.set('play_format', playFormat);
      p.set('difficulty', document.getElementById('difficulty').value);
      p.set('count', document.getElementById('count').value);
      p.set('timer', document.getElementById('timer').value);
      const base = gameSel.value;
      const join = base.includes('?') ? '&' : '?';
      document.getElementById('continueBtn').href = `${base}${join}${p.toString()}`;
    }
    ['change','input'].forEach(ev => {
      gameSel.addEventListener(ev, syncHref);
      document.getElementById('difficulty').addEventListener(ev, syncHref);
      document.getElementById('playFormat').addEventListener(ev, syncHref);
      document.getElementById('count').addEventListener(ev, syncHref);
      document.getElementById('timer').addEventListener(ev, syncHref);
    });
    function updateDifficultyLabel(){
      const sel = document.getElementById('difficulty');
      if (coverEl && sel) coverEl.textContent = DIFFICULTY_LABELS[sel.value] || 'Field Agent';
    }
    document.getElementById('difficulty').addEventListener('change', updateDifficultyLabel);
    updateDifficultyLabel();
    syncHref();
  </script>
</body>
</html>
